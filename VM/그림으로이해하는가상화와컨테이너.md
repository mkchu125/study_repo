그림으로 이해하는 가상화와 컨테이너
=============================

1.1 가상화란
-----------------------------
**실체가 없는 것을 존재하는 것처럼 보이게 하는 기술**
**물리서버 1대 : 가상 서버 여러 대 구축 가능**
물리 서버를 늘리지 않고 필요에 따라 서버를 늘리거나 줄일 수 있음 
=> 물리적 환경의 제약에 얽매이지 않고 유연하게 환경을 구축할 수 있음 (가상화의 유연성)

가상화를 이용하면 가상환경을 각각 환경별로 백업해 두는 것이 가능함.
**만약 가상환경이 고장나더라도 백업을 바탕으로 복원해 곧바로 이전의 상태로 되돌릴 수 있으므로 시스템의 가용성이 향상됨.
하지만 가상서버는 물리서버의 전원이 내려가면 사용할 수 없음.**

1.2 서버 가상화와 네트워크 가상화 
------------------------------
**서버 가상화 -=> 믈리 서버에서 가상서버를 구축하는 기술**
가상 서버는 호스트 OS와 다른 OS를 구축할 수 있음. 사양이 높을 수록 여러 가상서버를 동시 실행 및 네트워크를 통해 서로 참조 가능.

네트워크 가상화 => 물리적 네트워크 구성 가상화
네트워크 하나를 여러 가상 네트워크로 나누거나 여러 네트워크를 가상 네트워크 하나로 보이게 할 수 있음.
**네트워크 가상화를 도입하면 물리적 네트워크 기기를 보이지 않게 은폐** , 가상 스위치 등을 이용할 수 있어 네트워크를 간단하게 관리 및 유연한 변경 가능.

스토리지 가상화 => HDD SSD와 같은 스토리지 장치를 가상화함.
물리 스토리지 하나를 여러 논리 스토리지로 분할하거나 여러 물리 스토리지를 묶어 거대한 스토리지 하나로 처리

데스크톱 가상화 => 데스크톱 환경 가상화.
가상화된 데스크톱은 서버에서 실행되며 네트워크를 통해 접근하고 사용됨. 

1.3 가상화의 장단점
----------------------------
**가상화의 장점 : 백업이 쉬워 장애가 발생하더라도 이전 백업에서 환경을 복사해 쉽게 복원할 수 있다.** 
**가상 서버는 데이터 이므로 CPU나 메모리 등을  필요에 따라 증감해 스펙을 변경할 수 있고 복사와 삭제가 쉽다.(네트워트 기기의 관리 및 유지보수가 용이하다.)** 
스펙 증강(스케일 업), 서버 수 늘리는 것(스케일 아웃), 서버 수 줄이는 것(스케일 인)

가상화의 단점 : 가상화는 장애에 강하나, 물리 서버에 장애가 발생하면 해당 서버에서 실행되는 모든 가상 서버에 영항을 줄 수 있다.

1.4 가상화와 클라우드
----------------------------
클라우드 : 가상화 기술로 구축된 인프라나 그 위에 구축된 서비스 
Saas(Software as a Service) : 소프트웨어(응용 프로그램)로 제공되는 클라우드 서비스
ex) Gmail, Instagram, Facebook
PaaS(Platform as a Service) : 플랫폼으로 제공되는 클라우드 서비스
완성된 애플리케이션이 아니라 이를 구축하기 위해 필요한 스토리지 등을 제공하는 것, 사용자 스스로 애플리케이션을 구축해 이용하는 것을 상정
ex) Google App Engine, Cloud Foundry
IaaS(Infrastructure as a Service) : 인프라로 제공되는 클라우드 서비스
데이터베이스나 인터넷 등 환경 구축까지 사용자가 직접해야함, 개발의 자유도가 PaaS보다 높은 반면, 더 전문적인 지식 필요

1.5 클라우드 보안 
-----------------------------
클라우드의 리스크 : 취약성

2.1 서버 가상화의 원리 
-----------------------------
서버가상화의 종류에 따라 호스트OS와 게스트OS가 존재하는지 여부가 다름
호스트 OS 형 가상화 : 물리 서버에 설치된 호스트 OS에서 가상 서버가 동작
ex) 버츄얼 박스
하이퍼바이저형 가상화 : 호스트 OS의 일부 기능을 가상화 소프트웨어가 대행한다. 호스트 OS를 간소화해 효율적으로 유지 관리하기 쉽다.
ex) Hyper-V
컨테이너형 가상화 : 컨테이너라는 애플리케이션과 실제 환경을 같이 분리하는 원리를 사용해 OS단위가 아닌 애플리케이션 단위로 가상화한다.
게스트 OS가 없으며 컨테이너끼리 조합해 사용한다. 사용 리소스가 낮고 유연성이 높기 떄문에 웹 애플리케이션 개발 및 운영환경에 널리 사용되고 있다.
ex) Docker

2.2 호스트 OS형 가상화
-------------------------------
물리서버에 OS가 설치되어 가상 서버를 실행하는 기술
호스트 OS 리눅스 -> 게스트 OS 윈도 
어떤 게스트 OS를 실행할 수 있는지는 호스트 OS에 설치된 가상화 소프트웨어 종류에 따라 다름

2.3 하이퍼바이저형 가상화 
-------------------------------
호스트 OS가 필요 없다 => 물리 서버에 OS를 설치할 필요가 없다. 
그 대신 하이퍼바이저라는 가상환경을 관리하는 소프트웨어를 물리서버에 설치함.
물리 서버에 OS가 필요 없으므로 OS에 대한 라이선스 요금이 들지 않음.
호스트 OS 없이 게스트 OS를 직접 제어하기 때문에 컴퓨터의 리소스를 활용하기 쉽다. 

2.4 컨테이너형 가상화
------------------------------
컨테이너라는 애플리케이션과 실행 환경을 같이 분리하는 방식으로 OS단위가 아닌 애플리케이션 단위로 가상화하는 기술이다. 
게스트 OS를 사용하지 않고 호스트 OS에 컨테이너형 가상화 소프트웨어를 설치한다. 
**유연성** : 컨테이너형 가상화에서는 가상 서버를 늘리는 경우 컨티에너를 만들고 애플리케이션을 도입하기만 하면 가상서버를 준비할 수 있다.
번거로움을 줄이고 가상 하드웨어나 게스트 OS를 실행할 필요가 없어 성능도 좋아진다.
복잡한 컨테이너를 여러 개 만드는 것보다 하나의 컨테이너에 : 하나의 애플리케이션(프로세스) 단위로 구축하고 여러 컨테이너를 결합하는 것이 좋다. 
 

2.5 클라우드의 서버 가상화 
-------------------------------
아마존 EC2(Elastic Compute Cloud) 
하이퍼바이저 가상화로 AWS 스토리지 서비스인 아마존 S3(Simple Storage Service) 를 같이 사용할 수 있다.

2.6 네트워크 가상화의 원리
-------------------------------
물리적 네트워크 구성과는 다른 논리적 네트워크 구성을 나타내는 기술이다. 
네트워크는 물리적 라우팅을 변경하지 않아도 소프트웨어 구성으로 구축할 수 있다.

    [네트워크 가상화 기술]

    VLAN : 가상화된 LAN을 구축하는 기술. 하나의 LAN 환경을 복수의 LAN 환경으로 보이게 한다. 
    오버레이 네트워크 : VLAN보다 유연하게 네트워크 구성을 실현하는 기술. VLAN보다 큰 네트워크 가상화에 적합.
    VPN : 가상 사설망 구축
    SDN(Software-Defined Networking) : 소프트웨어로 네트워크의 각종 설정을 실시하는 기술 전반.
    OpenFlow : SDN을 실현하기 위한 구체적인 기술 중 하나.
    NFV : SDN을 보완하는 기술. 스위치(허브)나 라우터 등 네트워크 기기를 가상화할 수 있으며 그 설정을 소프트웨어로 제어할 수 있다.
    SD-WAN : 소프트웨어로 WAN을 정의하는 기술.


2.7 VLAN(Virtual LAN)
-----------------------------------
**물리적 네트워크(LAN : Local Area Network 근거리 통신망)를 분할해 여러 논리 네트워크를 구축하는 기술**
VLAN을 구현하는 일반적인 기술은 **포트 VLAN** 이다. **포트별로 번호를 매기고 그룹화한다.** 다른 번호의 포트 간에는 통신이 불가능하므로 가상으로 네트워크를 분할할 수 있다.
태그 VLAN : 데이터에 '태그'라는 식별자를 지정해 해당 데이터를 전송할 그룹을 나누는 기술.
네트워크 통신망을 통해 흐르고 있는 데이터를 올바른 수신그룹에 전달할 수 있다. 데이터에는 사전에 전달할 그룹의 태그가 스위치에 의해 할당된다.
> 스위치 > 태그 할당 > 데이터 전송 식별

2.8 오버레이 네트워크 
------------------------------------
물리적 네트워크 위에 가상 스위치를 설치 > 이를 이용해 가상 네트워크 구축
**물리적 네트워크 구성을 크게 변경하지 않고도 가상 네트워크 구성을 유연하게 변경할 수 있다.**
가상 스위치 간 터널링(패킷을 다른 패킷으로 덧씌워서 전송) 가능. VPN을 위한 통신의 암호화나 IPv6 -> IPv4 네트워크에 통과시키는 경우 등에 사용.

2.9 VPN(Virtual Private Network)
------------------------------------
사설망을 구축하는 기술. WAN(Wide Area Network : 거점 간 연결하는 네트워크망, 광역통신망) 의 일종.
인터넷상의 VPN 인터넷 VPN, 폐쇄형 네트워크를 이용한 IP-VPN

> 원리
> VPN은 오브레이 네트워크의 한 종류로, 터널링 기술을 사용한다. 멀리 떨어진 거점 간에는 VPN을 지원하는 라우터로 접속되어 인터넷 전용 커널을 구축한다. 
> VPN을 이용하면 암호화된 데이터로 터널 내부를 송수신하므로 제 3자에게 데이터를 도난당할 위험이 줄어든다.
> 데이터 암호화 기술로는 주로 IPSec이 사용됨.


2.10 SDN
------------------------------------
소프트웨어로 네트워크를 정의하는 기술
네트워크 환경을 구축하는 기기를 소프트웨어로 일괄 관리할 수 있으므로 관리 용이, 변경 유연한 네트워크 구성 가능.

OpenFlow : SDN을 구현하기 위한 기술로 여러 네트워크 기기를 중앙에서 관리할 수 있다.

2.11 NFV(Network Functions Virtualization)
-----------------------------------
SDN 보완기술로, 네트워크 장치의 기능을 가상 환경의 소프트웨어로 구현하는 기술이다. 
가상 서버에 라우터 및 허브와 같은 기기를 소프트웨어로 탑재하므로 구축 후 네트워크를 유연하게 변경할 수 있다.
(과거에는 네트워크 기기를 준비해야했었음 ㅇ0ㅇ)
SDN -> 소프트웨어에 의한 네트워크 정의(관리 및 구축)
NFV -> 네트워크 기능 가상화

> NFV 구성 아키텍처
> VNF(Virtual Network Function) : 가상화된 네트워크 장비
> NFVI(NFV Infrastructure) : NFV를 구성하기 위한 물리적 리소스, VNF를 제공함
> NFV MANO(NFV Management and Orchestration) : VNF, NFVI 제어, 다수의 소프트웨어나 장비 등을 통합적으로 제어한다.

2.12 SD-WAN
----------------------------------
SDN의 개념을 WAN으로 확장한 것. 광역 네트워크를 중앙 집중화해 가상 네트워크 환경을 구축 및 중앙 관리하는 것이 목표.
SD-WAN에서는 각 사이트에 CPE라는 전용 라우터가 있으며 CPE간 네트워크를 구축한다. CPE에는 제로터치 프로비저닝이라는 기능이 있어, 전원을 켜면 인터넷을 
통해 설정 정보를 읽어 자동으로 초기 설정을 할 수 있다. 

3.1 컨테이너 기술의 역사 
----------------------------------
유닉스의 chroot 명령어가 시초 -> 애플리케이션이 지정된 디렉터리만 접근 가능하도록 제한 
디렉터리마다 분리해 사용하므로 특정 애플리케이션의 프로세스가 다른 애플리케이션의 프로세스에 영향을 미치지 않는다. 
컨테이너형 가상화 = 애플리케이션을 격리하는 기술 
호스트형 os지만 간단하게 서버 가상화를 실현 -> 도커 
대량 컨테이너를 동시 사용하면서 관리가 번거로워진 문제를 해결하기 위해 -> 쿠버네티즈 개발(컨테이너 오케스트레이션 도구, 배포 및 관리 가능하게)

3.2 컨테이너 기술의 장점
----------------------------------
컨테이너 기술은 가상머신이나 게스트OS가 필요없다. 컨테이너를 생성하자마자 애플리케이션 배포해 가상 서버를 구축할 수 있다. 
도커 -> 주요 애플리케이션 및 라이브러리의 컨테이너 이미지를 모은 도커 허브 서비스 제공
게스트 OS가 없다 = 컨테이너 내 애플리케이션도 호스트 OS(커널)의 기능을 이용해 움직인다. 
파일 시스템이 독립적이기 때문에 호스트 OS 내 설치된 다른 애플리케이션이나 파일 등의 영향을 받지 않는다. 

데이터를 컨테이너에 포함하지 않는다. -> 애플리케이션용 컨테이너를 삭제해도 데이터는 손실되지 않으며 새 컨테이너 사용 가능 
호스트 OS형이나 하이퍼바이저형의 경우 애플리케이션이 기록하는데이터는 가상서버에 있다. -> 가상서버가 고장나면 손실 위험

3.3 데브옵스와 컨테이너 기술
----------------------------------
데브옵스 = 개발+운영(개발자와 운영자가 협력해 서비스를 제공하는 방법)
컨테이너 기술은 애플리케이션을 실행하는 데 필요한 프로그램과 라이브러리를 하나의 패키지로 결합 -> 컨테이너를 그대로 다른 서버로 옮겨도 작동함.

컨테이너 디 -> 컨테이너 이미지를 전송하거나 실행 및 감시, 라이프 사이클 등을 관리
크라이오 -> 경량 컨테이너 런타임, 쿠버네티즈에 특화되어있음.
컨테이너디와 크라이오 모두 CRI(Container Runtime Interface, 쿠버네티즈와 컨테이너 런타임이 통신할 때 사용하는 규정)에 근거 


3.5 마이크로 서비스 
----------------------------------
의존 관계가 없는 여러 작은 서비스를 조합해 큰 서비스로 제공하는 설계 기법 (큰 서비스를 구성하는 작은 서비스를 각각 독립적으로 가동할 수 있다.)
<-> 큰 기능을 단일의 서비스로 제공하는 설계 기법 모놀리스

3.6 컨테이너와 서버리스의 비교
----------------------------------
서버리스 : 서버가 존재하지 않는 환경 
주로 클라우드에서 제공되는 서비스, 최소 단위 기능(function) 사용자로부터 요청이 있을 때만 가동, 처리 끝나면 종료.
서버가 존재하지 않는 것이 아니라 개발자가 의식적으로 서버를 관리할 필요가 없는 것 뿐임.
(기존의 서버는 항상 가동하고 있으며 요청에 응답함.)

서버리스는 FaaS(Funcion as a Service) ex) AWS Lambda
장점 : 사용한 만큼 과금, 사용하지 않은 시간대에는 비용이 발생하지 않음.
서버 관리 필요 X, 개발 리소스 생략 가능 
단점 : 자유도, 휴대성 낮음
리소스 제한, 장시간 처리에 적합하지 않음, 표준화 되어있지 않음.

서버리스는 주로 클라우드에서 실행된다. 서버리스는 비교적 짧은 시간 안에 처리하는 데 사용된다.
어떤 장소에서 이미지 업로드 -> 서버리스에 등록한 기능 가동 -> 이미지 조절되거나 썸네일 자동 생성 등 
특정 클라우드에서 개발된 기능을 다른 클라우드 벤더로 이전하는 것은 난이도가 높음.

4.1 도커 
----------------------------------
컨테이너를 실행하거나 컨테이너 이미지(컨테이너를 실행하기 위한 템플릿)을 만들고 배포하는 플랫폼
